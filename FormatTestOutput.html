<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>FormatTestOutput - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Bypass.html">Bypass</a></li><li><a href="CloudMachineTest.html">CloudMachineTest</a><ul class='methods'><li data-type='method'><a href="CloudMachineTest.html#automatedTests">automatedTests</a></li><li data-type='method'><a href="CloudMachineTest.html#cleanup">cleanup</a></li><li data-type='method'><a href="CloudMachineTest.html#createInstance">createInstance</a></li><li data-type='method'><a href="CloudMachineTest.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="CloudMachineTest.html#ensureCredentials">ensureCredentials</a></li><li data-type='method'><a href="CloudMachineTest.html#manualSSH">manualSSH</a></li><li data-type='method'><a href="CloudMachineTest.html#manualSteps">manualSteps</a></li><li data-type='method'><a href="CloudMachineTest.html#prepareEnvironment">prepareEnvironment</a></li><li data-type='method'><a href="CloudMachineTest.html#preventRunawayServers">preventRunawayServers</a></li><li data-type='method'><a href="CloudMachineTest.html#runTests">runTests</a></li><li data-type='method'><a href="CloudMachineTest.html#setup">setup</a></li><li data-type='method'><a href="CloudMachineTest.html#test">test</a></li></ul></li><li><a href="FormatTestOutput.html">FormatTestOutput</a><ul class='methods'><li data-type='method'><a href="FormatTestOutput.html#_it">_it</a></li><li data-type='method'><a href="FormatTestOutput.html#allowAssertion">allowAssertion</a></li><li data-type='method'><a href="FormatTestOutput.html#indent">indent</a></li><li data-type='method'><a href="FormatTestOutput.html#indentLines">indentLines</a></li><li data-type='method'><a href="FormatTestOutput.html#it">it</a></li><li data-type='method'><a href="FormatTestOutput.html#resumeBypass">resumeBypass</a></li><li data-type='method'><a href="FormatTestOutput.html#section">section</a></li><li data-type='method'><a href="FormatTestOutput.html#startBypass">startBypass</a></li></ul></li><li><a href="GCETestMachine.html">GCETestMachine</a><ul class='methods'><li data-type='method'><a href="GCETestMachine.html#createInstance">createInstance</a></li><li data-type='method'><a href="GCETestMachine.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="GCETestMachine.html#getInstances">getInstances</a></li><li data-type='method'><a href="GCETestMachine.html#salt">salt</a></li><li data-type='method'><a href="GCETestMachine.html#ssh">ssh</a></li></ul></li><li><a href="IO.html">IO</a><ul class='methods'><li data-type='method'><a href="IO.html#bell">bell</a></li><li data-type='method'><a href="IO.html#formatYesNo">formatYesNo</a></li><li data-type='method'><a href="IO.html#status">status</a></li><li data-type='method'><a href="IO.html#yesNo">yesNo</a></li></ul></li><li><a href="TestError.html">TestError</a></li><li><a href="TestMachine.html">TestMachine</a><ul class='methods'><li data-type='method'><a href="TestMachine.html#createInstance">createInstance</a></li><li data-type='method'><a href="TestMachine.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="TestMachine.html#ensureServiceStarted">ensureServiceStarted</a></li><li data-type='method'><a href="TestMachine.html#ensureStarted">ensureStarted</a></li><li data-type='method'><a href="TestMachine.html#getInstances">getInstances</a></li><li data-type='method'><a href="TestMachine.html#ssh">ssh</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">FormatTestOutput</h1>
    

    




<section>

<header>
    
        <h2>
        FormatTestOutput
        </h2>
        
            <div class="class-description"><p>Provides a simplistic testing framework that integrates into seperate scripts and is based around dependent test
stages, unlike frameworks like Mocha which intend for parallel testing and must be run in their own environment.
<code>section</code> works like Mocha's <code>describe</code>, and <code>it</code> works similar to <code>it</code> in Mocha.</p>
<p>This framework should not be used in standard testing flows, as most tests should be independent.  However, when
testing a remote machine, chaining tests together is useful, as well as having greater control over test execution.</p>
<p>Test failure results in a Promise rejection, and must be manually allowed (with <code>allowAssertion</code>) to prevent other
tests from being skipped.  <code>startBypass</code>/<code>resumeBypass</code> are utilities for skipping dependent test sections after a
failure.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="FormatTestOutput"><span class="type-signature"></span>new FormatTestOutput<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line27">line 27</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





























    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="_it"><span class="type-signature"></span>_it<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line120">line 120</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Helper for <a href="FormatTestOutput.html#it">FormatTestOutput#it</a> to be used inside <code>.then()</code>.  Given same arguments as <code>it</code>.</p>
</div>









    <h5>Example</h5>
    
        <p class="code-caption">Comparison to 'it'</p>
    
    <pre class="prettyprint"><code>const out = new FormatTestOutput();
out
  .it("does something first", () => true)
  .then(() => out.it("then does this", () => true))
  .then(_it("then does this", () => true)); // Same as line above, but avoids an extra wrapper function.</code></pre>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>see <a href="FormatTestOutput.html#it">FormatTestOutput#it</a></p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="allowAssertion"><span class="type-signature"></span>allowAssertion<span class="signature">(err<span class="signature-attributes">opt</span>, cb<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line145">line 145</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Allows resumption of code after an assertion is thrown.</p>
</div>









    <h5>Examples</h5>
    
        <p class="code-caption">Resuming after failed assertion</p>
    
    <pre class="prettyprint"><code>const chai = require("chai"); const should = chai.should();
const out = new FormatTestOutput();
out
  .it("should fail", () => 1.should.equal(2))
  .catch(out.allowAssertion)
  .then(() => out.it("should continue", () => 2.should.equal(2)));</code></pre>

        <p class="code-caption">Calling a callback after failed assertion</p>
    
    <pre class="prettyprint"><code>const chai = require("chai"); const should = chai.should();
const out = new FormatTestOutput();
const test = "Foo Bar Baz"
out
  .it("should include 'bogus'", () => test.indexOf("bogus").should.equal(true))
  .catch(out.allowAssertion(err => console.log(out.indentLines(`Expected '${test}' to include 'bogus'.`))))
  .then(() => out.it("should continue", () => 2.should.equal(2)));</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>err</code></td>
            

            <td class="type">
            
                
<span class="param-type">Error</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>the thrown error.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>provide a custom callback to run while catching assertions.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>resolves if the given error is an <code>AssertionError</code>.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="indent"><span class="type-signature">(private) </span>indent<span class="signature">()</span><span class="type-signature"> &rarr; {String}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line39">line 39</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Utility for indenting sections of code.</p>
</div>























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the current indentation to add to the beginning of messages.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">String</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="indentLines"><span class="type-signature">(private) </span>indentLines<span class="signature">(msg)</span><span class="type-signature"> &rarr; {String}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line49">line 49</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Utility for indenting a multi-line string.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>msg</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>a multi-line message that should be indented.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the given message, with every line indented.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">String</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="it"><span class="type-signature"></span>it<span class="signature">(name, contents)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line95">line 95</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Run a single test, and logs to the console.  Prints any encountered errors to the console.  Works like Mocha's
<code>it</code>.</p>
</div>









    <h5>Example</h5>
    
        <p class="code-caption">Using 'it'</p>
    
    <pre class="prettyprint"><code>const chai = require("chai"); const should = chai.should();
const out = new FormatTestOutput();
out.it("adds", () => (1 + 1).should.equal(2));</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>a descriptive name for this test.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>contents</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>the test to run.  Should return a <code>Promise</code> if async.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the result of running the <code>contents</code>.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="resumeBypass"><span class="type-signature"></span>resumeBypass<span class="signature">(code)</span><span class="type-signature"> &rarr; {function}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line204">line 204</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Resumes testing code after bypassing tests.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>code</code></td>
            

            <td class="type">
            
                
<span class="param-type">Any</span>


            
            </td>

            

            

            <td class="description last"><p>the code from <a href="FormatTestOutput.html#startBypass">FormatTestOutput#startBypass</a> that should be resumed.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>can be used inside <code>.catch()</code> to resume test execution</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="section"><span class="type-signature"></span>section<span class="signature">(name, contents)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line69">line 69</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Start a section of testing.  Similar to Mocha's <code>describe</code> block.  Catches any errors from inside the <code>contents</code>,
and logs them to the console.</p>
</div>









    <h5>Example</h5>
    
        <p class="code-caption">Using 'section' with 'it'</p>
    
    <pre class="prettyprint"><code>const chai = require("chai"); const should = chai.should();
const out = new FormatTestOutput();
out.section("addition", () => {
  return it("adds numbers", () => (1 + 1).should.equal(2))
    .catch(out.allowAssertion)
    .then(out._it("continues", () => (1 + 2).should.equal(3))
    .catch(out.allowAssertion)
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>a descriptive name for this section.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>contents</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>the contents of this section.  Must return a Promise.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the returned value of <code>contents</code>.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="startBypass"><span class="type-signature"></span>startBypass<span class="signature">(code)</span><span class="type-signature"> &rarr; {function}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="FormatTestOutput.js.html">FormatTestOutput.js</a>, <a href="FormatTestOutput.js.html#line188">line 188</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Skips a section of testing.</p>
</div>









    <h5>Examples</h5>
    
        <p class="code-caption">Using a bypass</p>
    
    <pre class="prettyprint"><code>const chai = require("chai"); const should = chai.should();
const out = new FormatTestOutput();
out
  .it("should fail", () => 1.should.equal(2))
  .catch(out.startBypass("should-fail"))
  .it("should not run", () => 1.should.equal(2))
  .catch(out.resumeBypass("should-fail"))
  .it("should run", () => 1.should.equal(1));</code></pre>

        <p class="code-caption">Using two bypasses</p>
    
    <pre class="prettyprint"><code>const text = "A simple sentance.";
const out = new FormatTestOutput();
out
  .it("should have text", () => text.length.should.be.above(0))
  .catch(out.startBypass("no-text"))
  .it("should have at least three words", () => (text.match(' ') || []).length.should.be.at.least(2))
  .catch(out.startBypass("few-words"))
  .it("test depends on having text and at least 3 words", () => text.split(" ").length.should.be.at.least(3))
  .catch(out.allowAssertion)
  .catch(out.resumeBypass("few-words"))
  .it("test needs text, but doesn't need three words", () => text.length.should.be.above(1))
  .catch(out.allowAssertion)
  .catch(out.resumeBypass("no-text"))
  .it("doesn't need text and should always run", () => 1.should.equal(1));</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>code</code></td>
            

            <td class="type">
            
                
<span class="param-type">Any</span>


            
            </td>

            

            

            <td class="description last"><p>a code to identify the current bypass, so multiple bypasses can be used.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>can be used inside <code>.catch()</code> to start skipping tests.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>


    </dd>
</dl>

    


        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Jun 15 2017 16:52:34 GMT+0000 (UTC) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>