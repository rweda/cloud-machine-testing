<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>IO.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Bypass.html">Bypass</a></li><li><a href="CloudMachineTest.html">CloudMachineTest</a><ul class='methods'><li data-type='method'><a href="CloudMachineTest.html#automatedTests">automatedTests</a></li><li data-type='method'><a href="CloudMachineTest.html#cleanup">cleanup</a></li><li data-type='method'><a href="CloudMachineTest.html#createInstance">createInstance</a></li><li data-type='method'><a href="CloudMachineTest.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="CloudMachineTest.html#ensureCredentials">ensureCredentials</a></li><li data-type='method'><a href="CloudMachineTest.html#manualSSH">manualSSH</a></li><li data-type='method'><a href="CloudMachineTest.html#manualSteps">manualSteps</a></li><li data-type='method'><a href="CloudMachineTest.html#prepareEnvironment">prepareEnvironment</a></li><li data-type='method'><a href="CloudMachineTest.html#preventRunawayServers">preventRunawayServers</a></li><li data-type='method'><a href="CloudMachineTest.html#runTests">runTests</a></li><li data-type='method'><a href="CloudMachineTest.html#setup">setup</a></li><li data-type='method'><a href="CloudMachineTest.html#test">test</a></li></ul></li><li><a href="FormatTestOutput.html">FormatTestOutput</a><ul class='methods'><li data-type='method'><a href="FormatTestOutput.html#_it">_it</a></li><li data-type='method'><a href="FormatTestOutput.html#allowAssertion">allowAssertion</a></li><li data-type='method'><a href="FormatTestOutput.html#indent">indent</a></li><li data-type='method'><a href="FormatTestOutput.html#indentLines">indentLines</a></li><li data-type='method'><a href="FormatTestOutput.html#it">it</a></li><li data-type='method'><a href="FormatTestOutput.html#resumeBypass">resumeBypass</a></li><li data-type='method'><a href="FormatTestOutput.html#section">section</a></li><li data-type='method'><a href="FormatTestOutput.html#startBypass">startBypass</a></li></ul></li><li><a href="GCETestMachine.html">GCETestMachine</a><ul class='methods'><li data-type='method'><a href="GCETestMachine.html#createInstance">createInstance</a></li><li data-type='method'><a href="GCETestMachine.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="GCETestMachine.html#getInstances">getInstances</a></li><li data-type='method'><a href="GCETestMachine.html#salt">salt</a></li><li data-type='method'><a href="GCETestMachine.html#ssh">ssh</a></li></ul></li><li><a href="IO.html">IO</a><ul class='methods'><li data-type='method'><a href="IO.html#bell">bell</a></li><li data-type='method'><a href="IO.html#formatYesNo">formatYesNo</a></li><li data-type='method'><a href="IO.html#status">status</a></li><li data-type='method'><a href="IO.html#yesNo">yesNo</a></li></ul></li><li><a href="TestError.html">TestError</a></li><li><a href="TestMachine.html">TestMachine</a><ul class='methods'><li data-type='method'><a href="TestMachine.html#createInstance">createInstance</a></li><li data-type='method'><a href="TestMachine.html#destroyInstance">destroyInstance</a></li><li data-type='method'><a href="TestMachine.html#ensureServiceStarted">ensureServiceStarted</a></li><li data-type='method'><a href="TestMachine.html#ensureStarted">ensureStarted</a></li><li data-type='method'><a href="TestMachine.html#getInstances">getInstances</a></li><li data-type='method'><a href="TestMachine.html#ssh">ssh</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">IO.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const readline = require("readline");
const exec = require("child-process-promise").exec;
const chalk = require("chalk");

/**
 * Utilities for clean log output and user input.
*/
class IO {

  constructor() {
    this.yesRegex = /^([yY][eE][sS]|[yY])+$/;
    this.isCI = typeof process.env.CI !== "undefined";
    this.statusFormat = chalk.magenta;
    this.questionFormat = chalk.blue;
    this.ciAnswerFormat = chalk.yellow;
    this.formatDefault = chalk.bold;
  }

  /**
   * Provides a section header to mark a section of script running.
   * @param {String} msg the message to print.
   * @return {void}
  */
  status(msg) {
    console.log(`
      ${this.statusFormat(msg)}
    `);
  }

  /**
   * Rings an auditory bell when prompting for input.
   * @return {Promise} resolves when the sound is finished playing, or immediately if bell is disabled.
  */
  bell() {
    if(process.env.CI || process.env.NO_BELL) {
      return Promise.resolve();
    }
    return exec("paplay /usr/share/sounds/ubuntu/notifications/Xylo.ogg");
  }

  /**
   * Queries the user for a "yes/no" question.  If in CI, uses a default, and creates fake console output to simulate
   * asking the question to the user and getting a response, to allow the user to follow along.
   * @param {String} question the text of the question to ask the user.
   * @param {String} consoleDefault the default input if the user doesn't provide input.  Use `"Y"` or `"N"`.
   * @param {String} ciDefault the default input to use in CI.  Use `"Y"` or `"N"`.
   * @return {Promise&lt;Boolean>} `true` if the user answered "yes", `false` if the user answered "no".
   * @example &lt;caption>Basic Usage&lt;/caption>
   * const io = new IO();
   * io
   *    .yesNo("Use current directory, instead of '/var/my-app/'?", "Y", "N")
   *    .then(answer => console.log(answer ? "Using current directory." : "Using '/var/my-app/'."));
  */
  yesNo(question, consoleDefault, ciDefault) {
    if(this.isCI) {
      const {y, n} = this.formatYesNo(ciDefault);
      console.log(this.questionFormat(`${question} (${y}/${n}) `) + this.ciAnswerFormat(ciDefault.toUpperCase()));
      return Promise.resolve(this.yesRegex.test(ciDefault));
    }
    else {
      this.bell();
      const rl = readline.createInterface({ input: process.stdin, output: process.stdout });
      const askQuestion = (text) => new Promise(resolve => rl.question(text, resolve));
      const {y, n} = this.formatYesNo(consoleDefault);
      return askQuestion(this.questionFormat(`${question} (${y}/${n}) `))
        .then(answer => {
          rl.close();
          answer = (answer || "").trim();
          return this.yesRegex.test(answer.length > 0 ? answer : consoleDefault);
        });
    }
  }

  /**
   * Provides the format for the "Y/N" prompt.
   * @param {String} defaultVal the default value for the question.
   * @return {Object} `{ y, n }` containing formatted strings for the `Y` and `N` parts of the default input.
   * @private
  */
  formatYesNo(defaultVal) {
    return {
      y: this.yesRegex.test(defaultVal) ? this.formatDefault("Y") : "y",
      n: this.yesRegex.test(defaultVal) ? "n" : this.formatDefault("N"),
    };
  }

}

module.exports = IO;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Jun 15 2017 16:50:26 GMT+0000 (UTC) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
